# Second Brain โ ะะพะปะฝะฐั ะธะฝัะพัะผะฐัะธั ะพ ะฟัะพะตะบัะต

> **ะะพัะปะตะดะฝะตะต ะพะฑะฝะพะฒะปะตะฝะธะต:** 2026-01-13  
> **ะกัะฐััั:** โ Production (ัะฐะฑะพัะฐะตั)  
> **ะะตััะธั:** 2.0.0 (AI Agents)

---

## ๐ ะะณะปะฐะฒะปะตะฝะธะต

1. [ะะฑะทะพั ะฟัะพะตะบัะฐ](#-ะพะฑะทะพั-ะฟัะพะตะบัะฐ)
2. [Production ะพะบััะถะตะฝะธะต](#-production-ะพะบััะถะตะฝะธะต)
3. [ะััะธัะตะบัััะฐ](#-ะฐััะธัะตะบัััะฐ)
4. [ะกัััะบัััะฐ ัะฐะนะปะพะฒ](#-ััััะบัััะฐ-ัะฐะนะปะพะฒ)
5. [ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั](#-ะบะพะผะฟะพะฝะตะฝัั-ัะธััะตะผั)
6. [ะฃัััะฝัะต ะดะฐะฝะฝัะต](#-ััััะฝัะต-ะดะฐะฝะฝัะต)
7. [ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ](#-ะปะพะบะฐะปัะฝะฐั-ัะฐะทัะฐะฑะพัะบะฐ)
8. [ะะตะฟะปะพะน ะธ ะพะฑะฝะพะฒะปะตะฝะธะต](#-ะดะตะฟะปะพะน-ะธ-ะพะฑะฝะพะฒะปะตะฝะธะต)
9. [ะะพะฝะธัะพัะธะฝะณ ะธ ะพัะปะฐะดะบะฐ](#-ะผะพะฝะธัะพัะธะฝะณ-ะธ-ะพัะปะฐะดะบะฐ)
10. [ะะทะฒะตััะฝัะต ะพัะพะฑะตะฝะฝะพััะธ](#-ะธะทะฒะตััะฝัะต-ะพัะพะฑะตะฝะฝะพััะธ)
11. [ะงัะพ ัะดะตะปะฐะฝะพ](#-ััะพ-ัะดะตะปะฐะฝะพ)
12. [ะงัะพ ะฟะปะฐะฝะธััะตััั](#-ััะพ-ะฟะปะฐะฝะธััะตััั)

---

## ๐ฏ ะะฑะทะพั ะฟัะพะตะบัะฐ

**Second Brain** โ self-hosted ัะธััะตะผะฐ ัะฟัะฐะฒะปะตะฝะธั ะทะฐะผะตัะบะฐะผะธ ะฝะฐ ะฑะฐะทะต Obsidian.

### ะัะฝะพะฒะฝัะต ะฒะพะทะผะพะถะฝะพััะธ

| ะคัะฝะบัะธั | ะะฟะธัะฐะฝะธะต |
|---------|----------|
| **Obsidian LiveSync** | Realtime ัะธะฝััะพะฝะธะทะฐัะธั ะทะฐะผะตัะพะบ ะผะตะถะดั ััััะพะนััะฒะฐะผะธ |
| **AI Agents** | ๐ ะะฝัะตะปะปะตะบััะฐะปัะฝัะต ะฐะณะตะฝัั ะดะปั ะพะฑัะฐะฑะพัะบะธ ะทะฐะผะตัะพะบ |
| **Smart Note Taker** | ๐ ะะฒัะพะบะฐัะตะณะพัะธะทะฐัะธั ะธ ะธะทะฒะปะตัะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั |
| **Q&A Agent** | ๐ ะัะฒะตัั ะฝะฐ ะฒะพะฟัะพัั ะฟะพ ะฑะฐะทะต ะทะฝะฐะฝะธะน (RAG) |
| **Research Agent** | ๐ ะะปัะฑะพะบะธะน ะฐะฝะฐะปะธะท ะธ ัะธะฝัะตะท ะธะฝัะพัะผะฐัะธะธ ะฟะพ ัะตะผะฐะผ |
| **Telegram ะฑะพั** | ะััััะพะต ัะพะทะดะฐะฝะธะต ะทะฐะผะตัะพะบ ะธ ะธะฝัะตะปะปะตะบััะฐะปัะฝัะน ะฟะพะธัะบ |
| **REST API** | ะัะพะณัะฐะผะผะฝัะน ะดะพัััะฟ ะบ ะทะฐะผะตัะบะฐะผ |
| **Web Viewer** | ะัะพัะผะพัั ะทะฐะผะตัะพะบ ะฒ ะฑัะฐัะทะตัะต |
| **Auto SSL** | ะะฒัะพะผะฐัะธัะตัะบะธะต HTTPS ัะตััะธัะธะบะฐัั ัะตัะตะท Let's Encrypt |

### ะขะตัะฝะพะปะพะณะธัะตัะบะธะน ััะตะบ

| ะะพะผะฟะพะฝะตะฝั | ะขะตัะฝะพะปะพะณะธั | ะะตััะธั |
|-----------|------------|--------|
| ะะฐะทะฐ ะดะฐะฝะฝัั | CouchDB | 3.3.3 |
| Backend | FastAPI + Python | 3.11 |
| Telegram | python-telegram-bot | 21.0 |
| Reverse Proxy | Caddy | 2-alpine |
| **Vector DB** | **Qdrant** | **latest** |
| **LLM** | **Anthropic Claude** | **3.5 Sonnet** |
| **LLM** | **OpenAI GPT-4** | **Turbo** |
| **Embeddings** | **OpenAI** | **text-embedding-3-small** |
| **Reranking** | **Cohere** | **rerank-v3** |
| ะะพะฝัะตะนะฝะตัะธะทะฐัะธั | Docker Compose | v5.0.1 |
| ะฅะพััะธะฝะณ | Timeweb Cloud | โ |

---

## ๐ Production ะพะบััะถะตะฝะธะต

### ะกะตัะฒะตั

| ะะฐัะฐะผะตัั | ะะฝะฐัะตะฝะธะต |
|----------|----------|
| **ะัะพะฒะฐะนะดะตั** | Timeweb Cloud |
| **Server ID** | 6383807 |
| **Server Name** | second-brain |
| **IP ะฐะดัะตั** | 82.147.71.198 |
| **ะะก** | Ubuntu 22.04 LTS (5.15.0-164-generic) |
| **ะะตะณะธะพะฝ** | ru-2 |
| **ะกัะฐััั** | โ Online |

### ะะพะผะตะฝั ะธ DNS

| ะะพะผะตะฝ | ะขะธะฟ | ะะฝะฐัะตะฝะธะต | ะะฐะทะฝะฐัะตะฝะธะต |
|-------|-----|----------|------------|
| yakushev.me | โ | โ | ะัะฝะพะฒะฝะพะน ะดะพะผะตะฝ (Reg.ru) |
| notes.yakushev.me | A | 82.147.71.198 | CouchDB (Obsidian sync) |
| api.yakushev.me | A | 82.147.71.198 | REST API + Telegram ะฑะพั |

### ะะพะฝัะตะนะฝะตัั Docker

| ะะพะฝัะตะนะฝะตั | ะะฑัะฐะท | ะะพััั | ะกัะฐััั |
|-----------|-------|-------|--------|
| secondbrain-couchdb | couchdb:3.3.3 | 5984 (internal) | โ Healthy |
| secondbrain-api | second-brain-notes-api | 8000 (internal) | โ Healthy |
| **secondbrain-qdrant** | **qdrant/qdrant:latest** | **6333, 6334** | **โ Healthy** |
| secondbrain-caddy | caddy:2-alpine | 80, 443 | โ Running |

### ะกะตัั ะธ ัะฐะนัะฒะพะป

- **Docker network:** secondbrain-network (bridge)
- **UFW:** ะฐะบัะธะฒะตะฝ, ะพัะบัััั ะฟะพััั 22, 80, 443/tcp

### ะคะฐะนะปะพะฒะฐั ััััะบัััะฐ ะฝะฐ ัะตัะฒะตัะต

```
/root/
โโโ second-brain/           # ะัะพะตะบั
โ   โโโ .env                # ะะพะฝัะธะณััะฐัะธั (ัะตะบัะตัั)
โ   โโโ docker-compose.yml
โ   โโโ api/
โ   โโโ couchdb/
โ   โ   โโโ data/           # ะะฐะฝะฝัะต CouchDB (persistent)
โ   โโโ caddy/
โ   โ   โโโ data/           # SSL ัะตััะธัะธะบะฐัั
โ   โ   โโโ config/
โ   โโโ ...
โโโ second-brain-deploy.tar.gz  # ะััะธะฒ ะดะตะฟะปะพั
```

---

## ๐๏ธ ะััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                         INTERNET                                 โ
โ                                                                  โ
โ  Obsidian Desktop/Mobile          Telegram         Browser       โ
โ         โ                            โ                โ          โ
โโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโผโโโโโโโโโโโ
          โ                            โ                โ
          โผ                            โผ                โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  CADDY (secondbrain-caddy) - Reverse Proxy + Auto SSL           โ
โ  โโโ :80  โ redirect to :443                                    โ
โ  โโโ :443 notes.yakushev.me โ couchdb:5984                      โ
โ  โโโ :443 api.yakushev.me   โ notes-api:8000                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โ                            โ
          โผ                            โผ
โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  CouchDB            โ    โ  FastAPI (secondbrain-api)          โ
โ  (secondbrain-      โโโโโโค  โโโ REST API endpoints             โ
โ   couchdb)          โ    โ  โโโ Telegram Bot (polling)         โ
โ                     โ    โ  โโโ Web Viewer (/view)             โ
โ  :5984              โ    โ  :8000                              โ
โโโโโโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
          โฒ
          โ LiveSync protocol
โโโโโโโโโโโดโโโโโโโโโโ
โ  Obsidian         โ
โ  Self-hosted      โ
โ  LiveSync plugin  โ
โโโโโโโโโโโโโโโโโโโโโ
```

### ะะพัะพะบะธ ะดะฐะฝะฝัั

1. **Obsidian โ CouchDB**: ะกะธะฝััะพะฝะธะทะฐัะธั ัะตัะตะท LiveSync ะฟะปะฐะณะธะฝ
2. **Telegram โ API โ CouchDB**: ะกะพะทะดะฐะฝะธะต ะทะฐะผะตัะพะบ ัะตัะตะท ะฑะพัะฐ
3. **Browser โ API โ CouchDB**: ะัะพัะผะพัั ัะตัะตะท Web Viewer
4. **External โ API**: REST ะทะฐะฟัะพัั ั X-API-Token

---

## ๐ ะกัััะบัััะฐ ัะฐะนะปะพะฒ

```
second-brain/
โ
โโโ api/                          # Backend ะฟัะธะปะพะถะตะฝะธะต
โ   โโโ llm/                      # ๐ LLM Infrastructure
โ   โ   โโโ __init__.py
โ   โ   โโโ base.py               # ะะฐะทะพะฒัะน LLMProvider ะบะปะฐัั
โ   โ   โโโ claude_provider.py    # Claude API integration
โ   โ   โโโ openai_provider.py    # OpenAI API integration
โ   โ   โโโ manager.py            # LLM ัะฐะฑัะธะบะฐ ะธ ัะพััะธะฝะณ
โ   โ
โ   โโโ agents/                   # ๐ Agent System
โ   โ   โโโ __init__.py
โ   โ   โโโ base_agent.py         # ะะฐะทะพะฒัะน Agent ะบะปะฐัั
โ   โ   โโโ director.py           # Message ัะพััะตั
โ   โ   โโโ note_taker.py         # Smart Note Taker
โ   โ   โโโ qa_agent.py           # Q&A Agent (3-stage search)
โ   โ   โโโ research_agent.py     # Research Agent
โ   โ
โ   โโโ vector_store.py           # ๐ Qdrant ะบะปะธะตะฝั
โ   โโโ metadata_generator.py     # ๐ Metadata extraction ั LLM
โ   โโโ indexer.py                # ๐ Background indexing
โ   โ
โ   โโโ main.py                   # FastAPI ัะตัะฒะตั (ะพะฑะฝะพะฒะปะตะฝ)
โ   โโโ bot.py                    # Telegram ะฑะพั ั ะฐะณะตะฝัะฐะผะธ (ะพะฑะฝะพะฒะปะตะฝ)
โ   โโโ Dockerfile                # Python 3.11-slim
โ   โโโ requirements.txt          # ะะฐะฒะธัะธะผะพััะธ (ะพะฑะฝะพะฒะปะตะฝ)
โ   โโโ pytest.ini                # ะะพะฝัะธะณััะฐัะธั ัะตััะพะฒ
โ   โโโ tests/                    # Unit ัะตััั
โ       โโโ conftest.py           # Pytest ัะธะบััััั
โ       โโโ test_api.py           # 15 ัะตััะพะฒ
โ       โโโ test_agents.py        # ๐ ะขะตััั ะฐะณะตะฝัะพะฒ
โ       โโโ test_vector_store.py  # ๐ ะขะตััั Qdrant
โ       โโโ test_metadata.py      # ๐ ะขะตััั metadata
โ
โโโ couchdb/
โ   โโโ config/
โ       โโโ local.ini             # ะะพะฝัะธะณััะฐัะธั CouchDB
โ
โโโ qdrant/                       # ๐ Vector database
โ   โโโ storage/                  # ะะตะบัะพัะฝัะต ะดะฐะฝะฝัะต (ะฒ .gitignore)
โ
โโโ caddy/                        # ะะฐะฝะฝัะต Caddy (ะฒ .gitignore)
โ   โโโ data/                     # SSL ัะตััะธัะธะบะฐัั
โ   โโโ config/
โ
โโโ scripts/
โ   โโโ setup-server.sh           # ะะฐัััะพะนะบะฐ ะฝะพะฒะพะณะพ ัะตัะฒะตัะฐ
โ   โโโ init-couchdb.sh           # ะะฝะธัะธะฐะปะธะทะฐัะธั ะะ
โ   โโโ backup.sh                 # ะัะบะฐะฟ ะดะฐะฝะฝัั
โ
โโโ tools/                        # ะะฝััััะผะตะฝัั ัะฐะทัะฐะฑะพัะบะธ
โ   โโโ claude.py                 # Claude API CLI
โ   โโโ review.sh                 # Code review
โ   โโโ generate-tests.sh         # ะะตะฝะตัะฐัะธั ัะตััะพะฒ
โ   โโโ debug.sh                  # ะัะปะฐะดะบะฐ
โ   โโโ usage-stats.sh            # ะกัะฐัะธััะธะบะฐ API
โ
โโโ docs/
โ   โโโ AI_AGENTS.md              # ๐ ะะพะบัะผะตะฝัะฐัะธั AI ะฐะณะตะฝัะพะฒ
โ   โโโ CLAUDE_API_SETUP.md       # ะะฐัััะพะนะบะฐ Claude API
โ   โโโ DEPLOY.md                 # ะะฝััััะบัะธั ะดะตะฟะปะพั
โ
โโโ docker-compose.yml            # ะัะบะตัััะฐัะธั (4 ัะตัะฒะธัะฐ)
โโโ Caddyfile                     # ะะพะฝัะธะณััะฐัะธั reverse proxy
โโโ Makefile                      # 296 ัััะพะบ, ~40 ะบะพะผะฐะฝะด
โโโ .env.example                  # ะจะฐะฑะปะพะฝ ะฟะตัะตะผะตะฝะฝัั (ะพะฑะฝะพะฒะปะตะฝ)
โโโ .gitignore                    # ะัะบะปััะตะฝะธั Git (ะพะฑะฝะพะฒะปะตะฝ)
โโโ LICENSE                       # ๐ MIT License
โโโ README.md                     # ะัะฝะพะฒะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั (ะพะฑะฝะพะฒะปะตะฝ)
โโโ PLAN.md                       # ะะปะฐะฝ ะธ roadmap
โโโ PROJECT_STATUS.md             # ะญัะพั ัะฐะนะป
โโโ STATUS_RULES.md               # ะัะฐะฒะธะปะฐ ะพะฑะฝะพะฒะปะตะฝะธั ััะฐัััะฐ
โโโ IMPLEMENTATION_SUMMARY.md     # ๐ ะัะพะณะพะฒัะน ะพััะตั
```

---

## ๐ง ะะพะผะฟะพะฝะตะฝัั ัะธััะตะผั

### 1. CouchDB (secondbrain-couchdb)

**ะะฐะทะฝะฐัะตะฝะธะต:** ะฅัะฐะฝะตะฝะธะต ะทะฐะผะตัะพะบ ะฒ ัะพัะผะฐัะต, ัะพะฒะผะตััะธะผะพะผ ั Obsidian LiveSync.

**ะะพะฝัะธะณััะฐัะธั:**
- Single node mode
- CORS ะฒะบะปััะตะฝ ะดะปั ะฒัะตั origins (`origins = *`)
- CORS ะทะฐะณะพะปะพะฒะบะธ ะฟัะพะบัะธัััััั ัะตัะตะท Caddy
- Require authentication

**ะะฐะทั ะดะฐะฝะฝัั:**
- `_users` โ ัะธััะตะผะฝะฐั
- `_replicator` โ ัะธััะตะผะฝะฐั
- `obsidian_notes` โ ะพัะฝะพะฒะฝะฐั ะฑะฐะทะฐ ะทะฐะผะตัะพะบ

**ะะฝะดะตะบัั:**
- `mtime-index` โ ะดะปั ัะพััะธัะพะฒะบะธ ะฟะพ ะฒัะตะผะตะฝะธ
- `type-index` โ ะดะปั ัะธะปัััะฐัะธะธ ะฟะพ ัะธะฟั

### 2. FastAPI (secondbrain-api)

**ะะฐะทะฝะฐัะตะฝะธะต:** REST API ะธ Telegram ะฑะพั.

**Endpoints:**

| ะะตัะพะด | URL | ะะฟะธัะฐะฝะธะต |
|-------|-----|----------|
| GET | `/` | Health check (public) |
| GET | `/health` | ะะตัะฐะปัะฝัะน health check (public) |
| GET | `/view` | Web Viewer (public, ััะตะฑัะตั ัะพะบะตะฝ ะฒ UI) |
| POST | `/api/notes/quick` | ะกะพะทะดะฐัั ะทะฐะผะตัะบั |
| GET | `/api/notes/recent` | ะะพัะปะตะดะฝะธะต ะทะฐะผะตัะบะธ |
| GET | `/api/notes/search` | ะะพะธัะบ |
| GET | `/api/notes/summary` | ะะฝะตะฒะฝะฐั ัะฒะพะดะบะฐ |
| GET | `/api/notes/{id}` | ะะพะปััะธัั ะทะฐะผะตัะบั ะฟะพ ID |
| **GET** | **`/api/stats`** | **๐ ะกัะฐัะธััะธะบะฐ ัะธััะตะผั ะธ ะฐะณะตะฝัะพะฒ** |
| **POST** | **`/api/reindex`** | **๐ ะััะฝะฐั ะธะฝะดะตะบัะฐัะธั ะทะฐะผะตัะพะบ** |

**ะะฒัะพัะธะทะฐัะธั:** Header `X-API-Token`

### 3. Telegram Bot ั AI Agents

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฝัะตะปะปะตะบััะฐะปัะฝัะน ะธะฝัะตััะตะนั ะดะปั ัะฐะฑะพัั ั ะทะฐะผะตัะบะฐะผะธ.

**ะะตะถะธะผั ัะฐะฑะพัั:**
- **Smart Note Taking** โ ะฐะฒัะพะผะฐัะธัะตัะบะฐั ะบะฐัะตะณะพัะธะทะฐัะธั ะธ ะผะตัะฐะดะฐะฝะฝัะต
- **Q&A Mode** โ ะพัะฒะตัั ะฝะฐ ะฒะพะฟัะพัั ะฟะพ ะฑะฐะทะต ะทะฝะฐะฝะธะน
- **Research Mode** โ ะณะปัะฑะพะบะธะน ะฐะฝะฐะปะธะท ัะตะผ

**ะะพะผะฐะฝะดั:**

| ะะพะผะฐะฝะดะฐ | ะะฟะธัะฐะฝะธะต |
|---------|----------|
| `/start` | ะะปะฐะฒะฝะพะต ะผะตะฝั ั ะบะฝะพะฟะบะพะน Research |
| `/note <ัะตะบัั>` | ะกะพะทะดะฐัั ะทะฐะผะตัะบั |
| `/recent` | ะะพัะปะตะดะฝะธะต 10 ะทะฐะผะตัะพะบ |
| `/summary` | ะกะฒะพะดะบะฐ ะทะฐ ะดะตะฝั |
| `/search <ะทะฐะฟัะพั>` | ะะพะธัะบ |
| `/help` | ะกะฟัะฐะฒะบะฐ |
| **๐ Research (ะบะฝะพะฟะบะฐ)** | **๐ ะะตะถะธะผ ะณะปัะฑะพะบะพะณะพ ะธััะปะตะดะพะฒะฐะฝะธั** |
| ะะพะฟัะพั? | **๐ ะะฒัะพะผะฐัะธัะตัะบะธ โ Q&A Agent** |
| ะัะฑะพะน ัะตะบัั | **๐ โ Smart Note Taker Agent** |

**ะะตะทะพะฟะฐัะฝะพััั:** ะะพั ะพัะฒะตัะฐะตั ัะพะปัะบะพ ะฟะพะปัะทะพะฒะฐัะตะปั ั TELEGRAM_ADMIN_ID.

### 4. Qdrant (secondbrain-qdrant) ๐

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะตะบัะพัะฝะฐั ะฑะฐะทะฐ ะดะฐะฝะฝัั ะดะปั ัะตะผะฐะฝัะธัะตัะบะพะณะพ ะฟะพะธัะบะฐ.

**ะคัะฝะบัะธะธ:**
- ะฅัะฐะฝะตะฝะธะต embeddings ะทะฐะผะตัะพะบ (1536-ะผะตัะฝัะต ะฒะตะบัะพัั)
- ะกะตะผะฐะฝัะธัะตัะบะธะน ะฟะพะธัะบ ะฟะพ ัะพะดะตัะถะธะผะพะผั
- ะคะธะปัััะฐัะธั ะฟะพ ะผะตัะฐะดะฐะฝะฝัะผ (tags, category, date)
- ะัััััะน ะฟะพะธัะบ ะฟะพ ะผะธะปะปะธะพะฝะฐะผ ะฒะตะบัะพัะพะฒ

**ะะพะปะปะตะบัะธั:** `second_brain_notes`
**ะะพััั:** 6333 (HTTP), 6334 (gRPC)

### 5. AI Agents System ๐

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฝัะตะปะปะตะบััะฐะปัะฝะฐั ะพะฑัะฐะฑะพัะบะฐ ะทะฐะผะตัะพะบ ะธ ะทะฐะฟัะพัะพะฒ.

#### 5.1 Message Director
**ะะพะปั:** ะะพััะธะฝะณ ัะพะพะฑัะตะฝะธะน ะบ ะฟะพะดัะพะดััะตะผั ะฐะณะตะฝัั
- ะะฝะฐะปะธะท intent ัะตัะตะท LLM
- ะะฒัะพะผะฐัะธัะตัะบะธะน ะฒัะฑะพั ะฐะณะตะฝัะฐ
- ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะตะบััะพะผ ะดะธะฐะปะพะณะฐ

#### 5.2 Smart Note Taker Agent
**ะะพะทะผะพะถะฝะพััะธ:**
- ะะฒัะพะผะฐัะธัะตัะบะฐั ะบะฐัะตะณะพัะธะทะฐัะธั ะฒ ะฟะฐะฟะบะธ
- ะะทะฒะปะตัะตะฝะธะต ัะตะณะพะฒ ะธ ะบะปััะตะฒัั ัะปะพะฒ
- ะะตะฝะตัะฐัะธั ะบัะฐัะบะพะณะพ ัะตะทัะผะต
- ะะฟัะตะดะตะปะตะฝะธะต ะฟัะธะพัะธัะตัะฐ ะธ ะฝะฐัััะพะตะฝะธั
- ะะทะฒะปะตัะตะฝะธะต entities (ะปัะดะธ, ะบะพะผะฟะฐะฝะธะธ, ะผะตััะฐ)
- ะกะพะทะดะฐะฝะธะต embedding ะดะปั ะฟะพะธัะบะฐ

**ะขะตัะฝะพะปะพะณะธะธ:** Claude/OpenAI ะดะปั ะฐะฝะฐะปะธะทะฐ, OpenAI ะดะปั embeddings

#### 5.3 Q&A Agent
**ะะพะทะผะพะถะฝะพััะธ:**
- 3-stage ะฟะพะธัะบ: Metadata โ Hybrid Search โ Rerank
- ะะตะบัะพัะฝัะน ะฟะพะธัะบ ัะตัะตะท Qdrant (top 30)
- Full-text ะฟะพะธัะบ ัะตัะตะท CouchDB (top 30)
- Reranking ัะตัะตะท Cohere API (top 10)
- ะะตะฝะตัะฐัะธั ะพัะฒะตัะฐ ัะตัะตะท Claude/OpenAI
- ะกััะปะบะธ ะฝะฐ ะธััะพัะฝะธะบะธ

**ะัะตะผั ะพะฑัะฐะฑะพัะบะธ:** ~3-5 ัะตะบัะฝะด

#### 5.4 Research Agent
**ะะพะทะผะพะถะฝะพััะธ:**
- ะะปัะฑะพะบะธะน ะฐะฝะฐะปะธะท ะดะพ 100 ะทะฐะผะตัะพะบ
- ะะฝะพะณะพะฟัะพัะพะดะฝัะน ะฐะฝะฐะปะธะท:
  - Pass 1: ะะฑะทะพั ะธ ะบะปััะตะฒัะต ัะตะผั
  - Pass 2: ะกะฒัะทะธ ะธ ะฟะฐััะตัะฝั
  - Pass 3: ะกะธะฝัะตะท ะธ ะฒัะฒะพะดั
- ะกัััะบัััะธัะพะฒะฐะฝะฝัะน ะพััะตั
- ะััะฒะปะตะฝะธะต knowledge gaps

**ะัะตะผั ะพะฑัะฐะฑะพัะบะธ:** ~10-20 ัะตะบัะฝะด

### 6. Background Indexer ๐

**ะะฐะทะฝะฐัะตะฝะธะต:** ะะฒัะพะผะฐัะธัะตัะบะฐั ะธะฝะดะตะบัะฐัะธั ัััะตััะฒัััะธั ะทะฐะผะตัะพะบ.

**ะคัะฝะบัะธะธ:**
- ะกะบะฐะฝะธัะพะฒะฐะฝะธะต ะทะฐะผะตัะพะบ ะฑะตะท ะผะตัะฐะดะฐะฝะฝัั
- ะะตะฝะตัะฐัะธั ะผะตัะฐะดะฐะฝะฝัั ัะตัะตะท LLM
- ะกะพะทะดะฐะฝะธะต embeddings
- ะะฑะฝะพะฒะปะตะฝะธะต ะฒะตะบัะพัะพะฒ ะฒ Qdrant

**Rate limiting:** 5 ะทะฐะผะตัะพะบ ะฒ ะผะธะฝััั (ะทะฐัะธัะฐ ะพั rate limits API)

### 7. Caddy (secondbrain-caddy)

**ะะฐะทะฝะฐัะตะฝะธะต:** Reverse proxy ั ะฐะฒัะพะผะฐัะธัะตัะบะธะผ SSL.

**ะัะพะฑะตะฝะฝะพััะธ:**
- ะะฒัะพะผะฐัะธัะตัะบะพะต ะฟะพะปััะตะฝะธะต ัะตััะธัะธะบะฐัะพะฒ Let's Encrypt
- HTTP/2 ะธ HTTP/3 (QUIC)
- Gzip/Zstd ัะถะฐัะธะต
- ะัะพะบัะธัะพะฒะฐะฝะธะต ะฝะฐ ะฒะฝัััะตะฝะฝะธะต ัะตัะฒะธัั
- ะะพัะผะฐะปะธะทะฐัะธั HTTP ััะฐััั-ะบะพะดะพะฒ (201 โ 200) ะดะปั ัะพะฒะผะตััะธะผะพััะธ ั Obsidian LiveSync

---

## ๐ ะฃัััะฝัะต ะดะฐะฝะฝัะต

### Production (.env ะฝะฐ ัะตัะฒะตัะต)

```bash
# ะะพะผะตะฝั
DOMAIN=notes.yakushev.me
API_DOMAIN=api.yakushev.me

# CouchDB
COUCHDB_USER=obsidian_admin
COUCHDB_PASSWORD=oLqAXQNR7shrTj8T/g5zsgWlYKS/uHeA8RXUD3UtnX0=
COUCHDB_DATABASE=obsidian_notes

# API
API_SECRET_KEY=9ab5aafdfeef5e7f4b48277456e4aa513a6f509e0c34d31f6eb2b2c0b772cf7b
NOTES_API_TOKEN=e5200c625d5b1649aa17a6303d84d9bf75123b3a4d78b1db

# Telegram
TELEGRAM_BOT_TOKEN=8186895415:AAGt2GO_vKNKWWKrh5b5el7gFycPx2kpMw4
TELEGRAM_ADMIN_ID=1525875
```

### SSH ะดะพัััะฟ

```bash
# ะะปัั
~/.ssh/id_ed25519_timeweb

# ะะพะดะบะปััะตะฝะธะต
ssh -i ~/.ssh/id_ed25519_timeweb root@82.147.71.198

# ะะปะธ ั ะฟะฐัะพะปะตะผ
ssh root@82.147.71.198
# ะะฐัะพะปั: uMpGwL2Bm?+Q+g
```

### Timeweb CLI

```bash
# ะะพะฝัะธะณััะฐัะธั
~/.twc

# ะัะพะฒะตัะบะฐ
twc account info
twc server list
```

---

## ๐ป ะะพะบะฐะปัะฝะฐั ัะฐะทัะฐะฑะพัะบะฐ

### ะขัะตะฑะพะฒะฐะฝะธั

- Docker + Docker Compose
- Python 3.11+
- Make

### ะัััััะน ััะฐัั

```bash
# 1. ะะปะพะฝะธัะพะฒะฐัั ัะตะฟะพะทะธัะพัะธะน
git clone <repo>
cd second-brain

# 2. ะกะพะทะดะฐัั .env
cp .env.example .env
# ะะฐะฟะพะปะฝะธัั ะทะฝะฐัะตะฝะธั

# 3. ะะฐะฟัััะธัั
make dev

# 4. ะัะพะฒะตัะธัั
curl http://localhost:8000/health
```

### ะัะฝะพะฒะฝัะต ะบะพะผะฐะฝะดั

```bash
make help           # ะกะฟะธัะพะบ ะฒัะตั ะบะพะผะฐะฝะด
make dev            # ะะฐะฟััะบ ะฒ dev ัะตะถะธะผะต
make stop           # ะััะฐะฝะพะฒะบะฐ
make logs           # ะะพะณะธ ะฒัะตั ัะตัะฒะธัะพะฒ
make logs-api       # ะะพะณะธ API
make logs-db        # ะะพะณะธ CouchDB
make test           # ะะฐะฟััะบ ัะตััะพะฒ
make test-cov       # ะขะตััั ั ะฟะพะบัััะธะตะผ
make lint           # ะะธะฝัะตั
make format         # ะคะพัะผะฐัะธัะพะฒะฐะฝะธะต
make clean          # ะัะธััะบะฐ
```

### ะกัััะบัััะฐ ัะตััะพะฒ

```bash
cd api
python -m pytest tests/ -v              # ะัะต ัะตััั
python -m pytest tests/test_api.py -v   # ะขะพะปัะบะพ API ัะตััั
python -m pytest --cov=. --cov-report=html  # ะก ะฟะพะบัััะธะตะผ
```

---

## ๐ ะะตะฟะปะพะน ะธ ะพะฑะฝะพะฒะปะตะฝะธะต

### ะะตัะฒัะน ะดะตะฟะปะพะน (ัะถะต ะฒัะฟะพะปะฝะตะฝ)

ะกะผ. `docs/DEPLOY.md`

### ะะฑะฝะพะฒะปะตะฝะธะต ะบะพะดะฐ

```bash
# 1. ะะพะบะฐะปัะฝะพ: ัะฟะฐะบะพะฒะฐัั
make deploy-pack

# 2. ะะฐะณััะทะธัั ะฝะฐ ัะตัะฒะตั
make deploy-upload HOST=root@82.147.71.198

# 3. ะะฐ ัะตัะฒะตัะต
ssh -i ~/.ssh/id_ed25519_timeweb root@82.147.71.198
cd ~/second-brain
tar -xzvf ~/second-brain-deploy.tar.gz --overwrite
docker compose up -d --build
```

### ะัััััะต ะบะพะผะฐะฝะดั

```bash
# ะกัะฐััั
make deploy-status HOST=root@82.147.71.198

# ะะพะณะธ
make deploy-logs HOST=root@82.147.71.198

# ะะตัะตะทะฐะฟััะบ
make deploy-restart HOST=root@82.147.71.198

# SSH
make deploy-ssh HOST=root@82.147.71.198
```

---

## ๐ ะะพะฝะธัะพัะธะฝะณ ะธ ะพัะปะฐะดะบะฐ

### ะัะพะฒะตัะบะฐ ะทะดะพัะพะฒัั

```bash
# CouchDB
curl https://notes.yakushev.me/
# ะะถะธะดะฐะตะผะพ: {"error":"unauthorized"...}

# API
curl https://api.yakushev.me/health
# ะะถะธะดะฐะตะผะพ: {"status":"healthy","couchdb":{"connected":true,...}}
```

### ะะพะณะธ ะฝะฐ ัะตัะฒะตัะต

```bash
ssh -i ~/.ssh/id_ed25519_timeweb root@82.147.71.198

# ะัะต ะปะพะณะธ
cd ~/second-brain && docker compose logs -f

# ะะพะฝะบัะตัะฝัะน ัะตัะฒะธั
docker compose logs -f notes-api
docker compose logs -f couchdb
docker compose logs -f caddy
```

### ะกัะฐััั ะบะพะฝัะตะนะฝะตัะพะฒ

```bash
docker compose ps
docker stats
```

### ะงะฐัััะต ะฟัะพะฑะปะตะผั

| ะัะพะฑะปะตะผะฐ | ะะตัะตะฝะธะต |
|----------|---------|
| CouchDB unhealthy | ะัะพะฒะตัะธัั ะฟะฐัะพะปั ะฒ health-check, ะฟะตัะตะทะฐะฟัััะธัั |
| API ะฝะต ะพัะฒะตัะฐะตั | `docker compose restart notes-api` |
| SSL ะฝะต ัะฐะฑะพัะฐะตั | ะัะพะฒะตัะธัั DNS, ะปะพะณะธ Caddy |
| ะะพั ะฝะต ะพัะฒะตัะฐะตั | ะัะพะฒะตัะธัั TELEGRAM_BOT_TOKEN, ะปะพะณะธ API |

---

## โ๏ธ ะะทะฒะตััะฝัะต ะพัะพะฑะตะฝะฝะพััะธ

### ะัะฟัะฐะฒะปะตะฝะฝัะต ะฟัะพะฑะปะตะผั

1. **httpx ะบะพะฝัะปะธะบั** โ python-telegram-bot 21.0 ััะตะฑัะตั httpx~=0.27, ะธัะฟัะฐะฒะปะตะฝะพ ะฒ requirements.txt
2. **CouchDB health-check** โ ััะตะฑัะตั ะฐะฒัะพัะธะทะฐัะธั, ะดะพะฑะฐะฒะปะตะฝั credentials ะฒ docker-compose.yml
3. **CORS ะดะปั Obsidian LiveSync** โ ะธะทะผะตะฝัะฝ `origins` ะฝะฐ `*` ะฒ local.ini, ะดะพะฑะฐะฒะปะตะฝั CORS ะทะฐะณะพะปะพะฒะบะธ ะฒ Caddyfile (ะธัะฟัะฐะฒะปะตะฝะพ 2026-01-12)
4. **HTTP 201 ััะฐััั-ะบะพะด** โ CouchDB ะฒะพะทะฒัะฐัะฐะตั 201 Created ะดะปั PUT ะพะฟะตัะฐัะธะน, ะฝะพ Obsidian LiveSync ะพะถะธะดะฐะตั 200 OK. ะะพะฑะฐะฒะปะตะฝะฐ ะฝะพัะผะฐะปะธะทะฐัะธั ััะฐััั-ะบะพะดะพะฒ ะฒ Caddy ัะตัะตะท handle_response (ะธัะฟัะฐะฒะปะตะฝะพ 2026-01-12)
5. **docker-compose version** โ Warning ะพ `version` ัััะฐัะตะป, ะผะพะถะฝะพ ัะฑัะฐัั

### ะขะตะบััะธะต ะพะณัะฐะฝะธัะตะฝะธั

1. **ะะดะธะฝ ะฐะดะผะธะฝะธัััะฐัะพั** โ ะฑะพั ะพัะฒะตัะฐะตั ัะพะปัะบะพ ะพะดะฝะพะผั Telegram ID
2. **ะะตั E2E ัะธััะพะฒะฐะฝะธั ะฟะพ ัะผะพะปัะฐะฝะธั** โ ะฝะฐัััะฐะธะฒะฐะตััั ะฒ Obsidian
3. **ะะตั ะฑัะบะฐะฟะพะฒ ะฟะพ ัะฐัะฟะธัะฐะฝะธั** โ ัะพะปัะบะพ ัััะฝะพะน `make backup`

---

## โ ะงัะพ ัะดะตะปะฐะฝะพ

### Phase 1-7 (ะทะฐะฒะตััะตะฝั 2026-01-12)

- [x] Docker ะธะฝััะฐััััะบัััะฐ (CouchDB, Caddy, API)
- [x] REST API ะฝะฐ FastAPI
- [x] Telegram ะฑะพั
- [x] Web Viewer
- [x] Claude API ะธะฝัะตะณัะฐัะธั ะดะปั ัะฐะทัะฐะฑะพัะบะธ
- [x] Unit ัะตััั
- [x] Timeweb CLI ะธะฝัะตะณัะฐัะธั
- [x] Production ะดะตะฟะปะพะน ะฝะฐ Timeweb Cloud
- [x] SSL ัะตััะธัะธะบะฐัั ะธ ะดะพะผะตะฝั
- [x] CORS ะฝะฐัััะพะตะฝ ะดะปั Obsidian LiveSync

### Phase 8: AI Agents System (ะทะฐะฒะตััะตะฝะพ 2026-01-13) ๐

**Infrastructure:**
- [x] Qdrant vector database (Docker)
- [x] LLM Provider architecture (Claude + OpenAI)
- [x] ะะพะดัะปัะฝะฐั ัะธััะตะผะฐ ะฟัะพะฒะฐะนะดะตัะพะฒ
- [x] Metadata generator ั LLM
- [x] Vector embeddings (OpenAI text-embedding-3-small)
- [x] Cohere Rerank API integration

**Agents:**
- [x] Message Director โ ัะพััะธะฝะณ ะฟะพ intent
- [x] Smart Note Taker Agent:
  - [x] ะะฒัะพะบะฐัะตะณะพัะธะทะฐัะธั ะฒ ะฟะฐะฟะบะธ
  - [x] ะะทะฒะปะตัะตะฝะธะต ะผะตัะฐะดะฐะฝะฝัั (tags, keywords, entities)
  - [x] ะะตะฝะตัะฐัะธั summary
  - [x] ะะฟัะตะดะตะปะตะฝะธะต priority ะธ sentiment
  - [x] ะกะพะทะดะฐะฝะธะต embeddings
- [x] Q&A Agent โ 3-stage search pipeline:
  - [x] Stage 1: Metadata filtering
  - [x] Stage 2: Hybrid search (Qdrant + CouchDB)
  - [x] Stage 3: Cohere reranking + LLM synthesis
- [x] Research Agent โ ะณะปัะฑะพะบะธะน ะฐะฝะฐะปะธะท:
  - [x] Multi-pass LLM processing
  - [x] Structured reports
  - [x] Knowledge gap identification

**Indexing & API:**
- [x] Background indexer ะดะปั existing notes
- [x] Rate limiting (5 notes/min)
- [x] ะะพะฝะธัะพัะธะฝะณ endpoint `/api/stats`
- [x] ะััะฝะฐั reindexing `/api/reindex`

**Testing & Docs:**
- [x] Unit ัะตััั ะฐะณะตะฝัะพะฒ
- [x] Unit ัะตััั vector store
- [x] Unit ัะตััั metadata generator
- [x] ะะพะบัะผะตะฝัะฐัะธั `docs/AI_AGENTS.md`
- [x] Implementation summary

**GitHub:**
- [x] ะกะพะทะดะฐะฝ ะฟัะฑะปะธัะฝัะน ัะตะฟะพะทะธัะพัะธะน
- [x] MIT License
- [x] GitHub topics ะธ badges
- [x] URL: https://github.com/aim-samodelkin/second-brain

---

## ๐ฎ ะงัะพ ะฟะปะฐะฝะธััะตััั

### Phase 9: Production Deployment AI Agents

**ะััะพะบะธะน ะฟัะธะพัะธัะตั:**
- [ ] ะะตะฟะปะพะน Qdrant ะฝะฐ production ัะตัะฒะตั
- [ ] ะะฐัััะพะนะบะฐ LLM API keys ะฝะฐ ัะตัะฒะตัะต
- [ ] ะะฝะดะตะบัะฐัะธั ัััะตััะฒัััะธั ะทะฐะผะตัะพะบ
- [ ] ะะพะฝะธัะพัะธะฝะณ ะธัะฟะพะปัะทะพะฒะฐะฝะธั API (costs)
- [ ] Rate limiting ะดะปั LLM calls

### Phase 10: ะฃะปัััะตะฝะธั ะธ ะพะฟัะธะผะธะทะฐัะธั

**ะกัะตะดะฝะธะน ะฟัะธะพัะธัะตั:**
- [ ] ะััะธัะพะฒะฐะฝะธะต LLM responses (Redis)
- [ ] Batch processing ะดะปั indexing
- [ ] Webhook ะดะปั realtime indexing
- [ ] ะฃะปัััะตะฝะธะต prompt engineering
- [ ] A/B testing ัะฐะทะฝัั ะผะพะดะตะปะตะน

**ะะธะทะบะธะน ะฟัะธะพัะธัะตั:**
- [ ] ะะพะปะพัะพะฒัะต ะทะฐะผะตัะบะธ (Whisper API)
- [ ] ะะฐะฟะพะผะธะฝะฐะฝะธั ะฒ Telegram
- [ ] ะญะบัะฟะพัั ะฒ PDF
- [ ] ะัะฐั ัะฒัะทะตะน (Neo4j)
- [ ] ะะตะฑ-ัะตะดะฐะบัะพั
- [ ] ะัะฑะปะธัะฝัะต ัััะปะบะธ

---

## ๐ ะะพะฝัะฐะบัั ะธ ัััะปะบะธ

- **Telegram:** @sam_yakushev (ID: 1525875)
- **ะะพะผะตะฝ:** yakushev.me
- **GitHub:** https://github.com/aim-samodelkin/second-brain
- **Production:** https://api.yakushev.me

---

*ะะพะบัะผะตะฝั ะฐะบััะฐะปะตะฝ ะฝะฐ 2026-01-13. ะกะผ. STATUS_RULES.md ะดะปั ะฟัะฐะฒะธะป ะพะฑะฝะพะฒะปะตะฝะธั.*
